<main class="bazar">
  <h2>Bazar</h2>

  <section class="filters">
    <input [(ngModel)]="q" placeholder="Buscar título/autor/ISBN" />
    <input type="number" [(ngModel)]="minPrice" placeholder="Preço mín." />
    <input type="number" [(ngModel)]="maxPrice" placeholder="Preço máx." />

    <select [(ngModel)]="sort">
      <option value="recent">Mais recentes</option>
      <option value="price_asc">Preço ↑</option>
      <option value="price_desc">Preço ↓</option>
      <option value="title_asc">Título A→Z</option>
    </select>

    <button (click)="load(1)">Filtrar</button>
    <button class="secondary" (click)="clearFilters()">Limpar</button>
  </section>

  <hr />

  <p class="muted" *ngIf="loading">Carregando…</p>
  <p class="error" *ngIf="!loading && error">{{ error }}</p>

  <section class="grid" *ngIf="!loading && !error">
    <app-offer-card
      *ngFor="let it of items"
      variant="grid"
      [oferta]="toOferta(it)"
      [quantity]="getQuantity(it)"
      [maxStock]="it.stock"
      (increaseQty)="increase(it)"
      (decreaseQty)="decrease(it)"
      (addToCart)="addToCart(it)"
    ></app-offer-card>
  </section>

  <footer class="pager" *ngIf="total > pageSize && !loading && !error">
    <button (click)="load(page-1)" [disabled]="page<=1">◀</button>
    <span>Página {{page}} / {{ pages }}</span>
    <button (click)="load(page+1)" [disabled]="page>=pages">▶</button>
  </footer>
</main>
